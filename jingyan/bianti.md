# 主题变体实施思路

## 目标

- 在不改动核心架构、数据库结构和业务流程（认证、圈地、建筑、交易、通讯、StoreKit）的前提下，为《地球新主》提供多种主题皮肤，适合教学或演示不同受众。
- 所有变体仅修改文案、静态资源、Supabase 数据内容，不触及 Swift 代码中的 Manager/流程。

## 可选题材示例

1. **旅行守护者**：圈地记录旅行足迹，建筑=旅行设施；通讯=旅人电台。

2. **魔法巡游**：圈地净化区域，建筑=魔法塔/药草园；交易=魔法材料交换。

3. **治愈花园**：圈地绿化城市，建筑=花园/温室；动态消息走“园艺/生态”风格。
   
   > 可以按受众喜好再衍生（咖啡寻宝、宠物散步、花海巡游等），核心玩法保持不变。

## 修改边界

| 层级        | 可改内容                                                                                                                                  | 保持不变                       |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------- | -------------------------- |
| **客户端文案** | `EarthLord/zh-Hans.lproj/Localizable.strings`、`en.lproj` 内的 keys，以及 Swift 常量中的描述文字                                                    | 文案键名、编码格式、Localization 机制  |
| **数据内容**  | Supabase 表中的记录（`building_templates`, `item_definitions`, `dynamic_messages`, `scripts/` 导入的 JSON/SQL）                                 | 表结构、字段、迁移脚本、触发器            |
| **素材资源**  | `EarthLord/Resources/BuildingImages/*`, `Assets.xcassets`, `media`、`sounds` 中的图片/音频/视频；Supabase Storage `building-images` bucket 中的文件 | 资源命名规范、引用路径、缓存逻辑           |
| **体验包装**  | 动态消息词库、任务描述、IAP 商品文案                                                                                                                  | IAP 产品 ID、StoreKit 配置、付费逻辑 |

## 实施步骤

1. **跑通原版**：按 README 指南完成所有 Manager、Supabase 迁移、Edge Functions、StoreKit 配置，确保原始功能闭环正常。
2. **准备主题包**：
   - 文案映射表（Key → 新文案），遵守 `docs/localization-lessons-learned.md` 的 UTF-16 BE 规则。
   - 数据映射表（建筑模板 ID → 新名称/描述/图标 URL），可编辑 `building_templates.json` 并导入 Supabase。
   - 资源清单（图片/音效/视频），使用 AI 生图或设计工具，保持文件名/尺寸要求。
3. **替换流程**：
   - 更新 Supabase Storage 中的图像文件，或上传新版本并更新表记录。
   - 修改 `building_templates`, `dynamic_messages`, `item_definitions` 等表的记录内容。
   - 更新本地化文件中的文案并验证编码。
4. **验证**：
   - 真机运行，检查地图、建筑、动态消息、交易界面是否呈现新主题。
   - 确认交易、通讯、StoreKit 等深度系统仍按原逻辑运作。
5. **文档化**：
   - 为每个主题保存“资源映射表 + 数据脚本 + 预览图”，方便课堂演示和学生切换。

## 教学建议

- 先用原版示范完整闭环，再提供主题包让学生体验“换皮不换核”的迭代流程。
- 引导学生在 Supabase Dashboard 里亲自修改几条记录，观察 App 实时变化，理解前后端联动。
- 结合 AI 生成素材的示例（如 Midjourney/DALL·E 提示词），让学生尝试制作自己的建筑/主题图片。

---

以上文档可作为课堂说明：复刻完成后，如何通过调整文案与资源，在不破坏核心代码的前提下打造适合不同受众的变体。
