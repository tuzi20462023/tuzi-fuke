# åœ°çƒæ–°ä¸»å¤åˆ»è§„åˆ’ï¼ˆAIè¾…åŠ©ä¸€å‘¨å†²åˆºï¼‰

## 1. ç›®æ ‡ä¸èŒƒå›´

- **æ ¸å¿ƒç›®æ ‡**ï¼šåœ¨ 1 å‘¨å†…åŸºäº AI è¾…åŠ©å®Œæˆã€Šåœ°çƒæ–°ä¸»ã€‹MVP å¤åˆ»ï¼Œé‡ç‚¹å±•ç¤ºâ€œå®šä½â†’åœˆåœ°â†’å»ºé€ â€é—­ç¯ã€‚
- **æ¼”ç¤ºè¦æ±‚**ï¼šçœŸæœºè¿è¡Œï¼Œèƒ½å®ŒæˆåŒ¿åç™»å½•ã€å®æ—¶å®šä½ã€åœ°å›¾åœˆå ã€å»ºç­‘æ”¾ç½®ã€åŸºç¡€ UI å±•ç¤ºã€‚
- **æŠ€æœ¯æ ˆ**ï¼šiOS 15+/SwiftUI/CoreLocation/MapKit/Supabaseï¼Œéµå¾ªåŸä»“åº“ `README.md` ä¸­çš„æ‰€æœ‰å¼ºåˆ¶å‡†åˆ™ã€‚

## 2. æ€»ä½“ç­–ç•¥

1. **æ–‡æ¡£å…ˆè¡Œ**ï¼šé¦–æ—¥é€šè¯» `README.md`ã€`PROJECT_INFO.md`ã€`docs/æ ¸å¿ƒåŠŸèƒ½å®ç°è§„èŒƒ_V4.2.md`ã€`docs/dynamic-message-system/*`ã€`docs/localization-lessons-learned.md`ï¼Œåˆ—å‡ºå¿…é¡»éµå®ˆçš„æŠ€æœ¯çº¢çº¿ã€‚
2. **åç«¯å…ˆæ‰“åº•**ï¼šåŒæ­¥ `supabase/migrations`ã€`supabase/functions`ã€`EarthLord/Resources`ï¼Œç¡®ä¿æ•°æ®åº“ã€å‡½æ•°ã€å­˜å‚¨ã€StoreKit æµ‹è¯•ç¯å¢ƒé½å¤‡å†å†™å®¢æˆ·ç«¯ã€‚
3. **é—­ç¯ä¼˜å…ˆ**ï¼šèšç„¦â€œAuth + GPS + åœ°å›¾åœˆå  + å»ºç­‘å±•ç¤ºâ€ä¸»é“¾è·¯ï¼Œå…¶ä½™ç³»ç»Ÿï¼ˆé€šè®¯ã€äº¤æ˜“ã€IAPï¼‰å»¶åã€‚
4. **AI è¿­ä»£**ï¼šæ¯ä¸ªåŠŸèƒ½æ‹†åˆ†æˆæ˜ç¡®çš„è¾“å…¥/è¾“å‡ºï¼Œç¼–å†™æç¤ºè¯è®© AI ç”Ÿæˆä»£ç  â†’ äººå·¥å®¡æŸ¥ â†’ çœŸæœºéªŒè¯ â†’ è®°å½•é—®é¢˜ç»™ä¸‹ä¸€è½®æç¤ºã€‚

## 3. ç¯å¢ƒå‡†å¤‡

- macOS 12+/Xcode 14+ã€Swift 5ã€CocoaPods/SwiftPMï¼ˆè§†ä¾èµ–è€Œå®šï¼‰ã€‚
- Supabase CLI + Deno 1.37+ï¼Œç™»å½•ååˆ›å»ºæ–°é¡¹ç›®ï¼ˆregion ap-southeast-1 ä¼˜å…ˆï¼‰ã€‚
- Apple å¼€å‘è€…è´¦å·è®¾ç½®å®šä½ã€åå°æ›´æ–°ã€MapKitã€StoreKit æµ‹è¯•è¯ä¹¦ï¼›å‡†å¤‡åŒ¿åç™»å½•æ‰€éœ€çš„ Info.plist æƒé™æ–‡æ¡ˆã€‚

## 4. Supabase åç«¯å¤åˆ»

1. **é¡¹ç›®åˆ›å»º**ï¼šåœ¨ Supabase æ§åˆ¶å°æ–°å»ºé¡¹ç›®ï¼Œè®°å½• URL/Anon Keyï¼Œå¹¶æ›´æ–° `SupabaseConfig.swift`ã€‚
2. **æ•°æ®åº“è¿ç§»**ï¼šä½¿ç”¨ `supabase db reset && supabase db push`ï¼ˆæˆ–é€æ¡ `mcp__supabase__apply_migration`ï¼‰åº”ç”¨ `supabase/migrations/` å…¨éƒ¨ SQLã€‚
3. **å­˜å‚¨èµ„æº**ï¼šåˆ›å»º `building-images` bucketï¼Œä¸Šä¼  `EarthLord/Resources/BuildingImages/*`ï¼Œä¿æŒ `{template_id}_{thumbnail/full}.png` å‘½åã€‚
4. **åˆå§‹æ•°æ®**ï¼šå¯¼å…¥ `EarthLord/building_templates.json`ã€å¿…è¦çš„ `insert_message_templates.sql` ç­‰åŸºç¡€æ•°æ®ã€‚
5. **Edge Functions**ï¼šåœ¨ `supabase/functions/` ç›®å½•é€ä¸ª `supabase functions deploy <name>`ï¼›é…ç½®ç¯å¢ƒå˜é‡ `SUPABASE_URL`ã€`SUPABASE_SERVICE_ROLE_KEY`ã€‚
6. **æµ‹è¯•è¡¨**ï¼šä¸º MVP å»ºç«‹ç®€åŒ–è¡¨ `positions`, `territories`, `buildings`ï¼Œå­—æ®µéµç…§åŸé¡¹ç›®æ¨¡å‹ä½†å…è®¸è£å‰ªï¼ˆDay2/Day3/Day4 ä½¿ç”¨ï¼‰ã€‚

## 5. iOS å®¢æˆ·ç«¯å¤åˆ»æ­¥éª¤

### Day 1 â€“ é¡¹ç›®éª¨æ¶

- æ–°å»º SwiftUI Appï¼Œé›†æˆ Supabase SDKã€MapKitã€CoreLocationï¼Œé…ç½® Info.plist æƒé™ã€‚
- å®ç° `SupabaseConfig`ã€`SupabaseManager`ã€`AuthManager`ï¼ˆåŒ¿åç™»å½•å³å¯ï¼‰ã€`LocationManager`ï¼ˆå®šä½æˆæƒ+å•æ¬¡è·å–ï¼‰ã€‚
- è¾“å‡ºå¯è¿è¡Œ Demoï¼ŒéªŒè¯å®šä½å¼¹çª—ã€Supabase åŒ¿åç™»å½•æˆåŠŸã€‚

### Day 2 â€“ å®šä½ä¸æ•°æ®é‡‡é›†

- LocationManager å¢å¼ºï¼šåå°/å‰å°æŒç»­å®šä½ï¼Œæ¯ 10s push ä½ç½®ä¿¡æ¯ â†’ Supabase `positions`ã€‚
- SwiftUI `LocationView` å®æ—¶å±•ç¤ºç»çº¬åº¦ã€ç²¾åº¦ã€ä¸Šä¼ çŠ¶æ€ã€‚
- æ„å»ºåŸºç¡€ `DataRepository` æŠ½è±¡ï¼Œå°è£…ä½ç½®/é¢†åœ°/å»ºç­‘çš„ CRUDã€‚

### Day 3 â€“ åœ°å›¾ä¸åœˆåœ°

- é›†æˆ MapKitï¼Œå±•ç¤ºç”¨æˆ·ä½ç½®ã€å†å²è½¨è¿¹ã€‚
- ç‚¹å‡»åœ°å›¾ä»»æ„ç‚¹ â†’ ç”Ÿæˆ 50m åœ†å½¢é¢†åœ° â†’ å†™å…¥ `territories` â†’ æœ¬åœ° overlay æ¸²æŸ“ï¼Œæä¾›åˆ—è¡¨æŸ¥çœ‹ã€‚
- é¢„ç•™åœˆåœ°æ ¡éªŒæ¥å£å¯¹æ¥ `validate-territory` Edge Functionï¼ˆå…ˆå¯ç›´æ¥é€šè¿‡ï¼‰ã€‚

### Day 4 â€“ å»ºç­‘ç³»ç»Ÿ

- è®¾è®¡ `BuildingType`ï¼ˆ3-5 ç§ï¼‰ï¼Œå®ç°å»ºç­‘æ”¾ç½® UIï¼šé€‰æ‹©é¢†åœ° â†’ é€‰ç±»å‹ â†’ æŒ‡å®šè½ç‚¹ â†’ ä¿å­˜ `buildings` â†’ åœ°å›¾ annotation æ˜¾ç¤ºã€‚
- ç®€åŒ–å»ºé€ é€»è¾‘ï¼šå³æ—¶å®Œæˆï¼Œæ˜¾ç¤ºä¸åŒé¢œè‰²/å›¾æ ‡ã€‚
- ä¸ Supabase æ•°æ®åŒæ­¥ï¼Œæ”¯æŒåˆ·æ–°å’Œåˆ é™¤ã€‚

### Day 5 â€“ UI ä¸ä½“éªŒ

- æ„å»ºæœ«æ—¥ä¸»é¢˜ Shellï¼ˆæ·±è‰²è°ƒã€æ¸å˜/å™ªç‚¹èƒŒæ™¯ï¼‰ã€‚
- æ•´åˆåœ°å›¾é¡µã€å»ºé€ åˆ—è¡¨ã€ç©å®¶é¢æ¿ï¼Œé€šè¿‡ `TabView` æˆ– `NavigationStack` ç»„ç»‡ã€‚
- åŠ å…¥çŠ¶æ€æç¤ºï¼ˆå®šä½çŠ¶æ€ã€ä¸Šä¼ æˆåŠŸ/å¤±è´¥ã€é¢†åœ°æ•°ã€å»ºç­‘æ•°ï¼‰ã€‚

### Day 6-7 â€“ æ‰“ç£¨ä¸æ¼”ç¤º

- çœŸæœºå›å½’æµ‹è¯•ï¼Œå½•åˆ¶æ¼”ç¤ºæµç¨‹ã€‚
- ä¿®å¤æ€§èƒ½/å´©æºƒé—®é¢˜ï¼Œå®Œå–„æ—¥å¿—ä¸é”™è¯¯æç¤ºã€‚
- å‡†å¤‡æ¼”ç¤ºè„šæœ¬ã€æ¼”ç¤ºè´¦å·ã€é¢„ç½®æ•°æ®ï¼Œå½¢æˆå¯é‡å¤å±•ç¤ºçš„ demoã€‚

## 6. é£é™©ä¸ç¼“è§£

| é£é™©               | å½±å“      | é¢„æ¡ˆ                                 |
| ---------------- | ------- | ---------------------------------- |
| Supabase è¿ç§»/å‡½æ•°å¤æ‚ | é˜»å¡å®¢æˆ·ç«¯è°ƒè¯• | å…ˆæ­å»ºæœ€å° schema ä¸å¿…è¦å‡½æ•°ï¼Œå¤æ‚è¿ç§»åˆ†é˜¶æ®µéªŒè¯       |
| å®šä½æƒé™/çœŸæœºå·®å¼‚        | æ¼”ç¤ºå¤±è´¥    | æ¯æ™šçœŸæœºå·¡æ£€ + å½•å±å¤‡ç”¨                      |
| AI ç”Ÿæˆä»£ç è´¨é‡ä¸ç¨³      | è¿”å·¥      | åšæŒâ€œå°ä»»åŠ¡â†’æç¤ºâ†’å®¡æŸ¥â†’è¿è¡Œâ€å¾ªç¯ï¼Œå¿…è¦æ—¶æä¾›ç°æœ‰ä»£ç ç‰‡æ®µä½œä¸Šä¸‹æ–‡ |
| æ—¶é—´ä¸è¶³             | åŠŸèƒ½æ®‹ç¼º    | æ‰€æœ‰æ–°éœ€æ±‚æŒ‰â€œåœˆåœ°é—­ç¯ä¼˜å…ˆâ€è¿‡æ»¤ï¼Œå…¶ä»–è¿›å…¥å¾…åŠ            |

## 7. AI åä½œæ¨¡æ¿

```
è§’è‰²ï¼šä½ æ˜¯ä¸€åèµ„æ·± iOS/Supabase å·¥ç¨‹å¸ˆ
ä»»åŠ¡ï¼š[æè¿°åŠŸèƒ½ï¼Œå¦‚â€œå®ç° MapKit åœˆåœ°å¹¶ä¿å­˜ Supabaseâ€]
ä¸Šä¸‹æ–‡ï¼š[åˆ—å‡ºç›¸å…³æ¨¡å‹/æ¥å£/çº¦æŸ]
è¾“å‡ºè¦æ±‚ï¼š
- Swift ä»£ç å¯ç›´æ¥ç²˜è´´è¿è¡Œ
- åŒ…å«å¿…è¦çš„æ¨¡å‹ã€è§†å›¾ã€Manager
- æä¾› Supabase è¡¨ç»“æ„/SQLï¼ˆå¦‚éœ€è¦ï¼‰
- è¯´æ˜å¦‚ä½•åœ¨ç°æœ‰é¡¹ç›®ä¸­é›†æˆ
```

## 8. é‡Œç¨‹ç¢‘ä¸äº¤ä»˜

1. **M1ï¼ˆDay2ï¼‰**ï¼šåŒ¿åç™»å½• + å®šä½ä¸Šä¼  + UI å±•ç¤ºã€‚
2. **M2 (Day3)**ï¼šåœ°å›¾åœˆåœ°é—­ç¯å®Œæˆã€‚
3. **M3 (Day4)**ï¼šå»ºç­‘æ”¾ç½®ä¸å±•ç¤ºå®Œæˆã€‚
4. **M4 (Day5)**ï¼šæœ«æ—¥é£æ ¼ UI + ä¸»ç•Œé¢ä¸²è”ã€‚
5. **M5 (Day7)**ï¼šæ¼”ç¤ºè„šæœ¬ä¸çœŸæœºå½•åƒäº¤ä»˜ã€‚

---

> æ¯æ—¥ç»“æŸå‰åŠ¡å¿…åœ¨çœŸæœºéªŒè¯å½“å¤©é—­ç¯ï¼Œè®°å½•é—®é¢˜æ¸…å•ï¼›æ¬¡æ—¥ä»¥é—®é¢˜é©±åŠ¨ AI è¾…åŠ©å¼€å‘ï¼Œä¿è¯èŠ‚å¥ä¸è´¨é‡ã€‚

## ğŸ”„ 2025-11-21 08:48 æ›´æ–°

### Day1 è¿›å±•æ‘˜è¦

- âœ… å·¥ç¨‹åˆå§‹åŒ–å®Œæˆï¼ˆXcode é¡¹ç›®ã€Info.plist æƒé™ã€ä¸´æ—¶ `SupabaseConfig`ã€`tuzi_fukeApp` éª¨æ¶ï¼‰ã€‚
- âœ… ä¸‰å¤§æ ¸å¿ƒ Managerï¼ˆ`AuthManager`ã€`LocationManager`ã€`DataManager`ï¼‰å’ŒåŸºç¡€æ¨¡å‹ (`User`, `Territory`, `Building`) è½åœ°ï¼Œå¹¶é€šè¿‡æµ‹è¯•è§†å›¾åœ¨çœŸæœºéªŒè¯è¿è¡Œã€‚
- âœ… Day1 æ•™å­¦æŒ‡å—å’Œæç¤ºè¯æ•´ç†å®Œæ¯•ï¼Œå¯å¤ç”¨åœ¨è¯¾å ‚æ¼”ç¤ºã€‚

### ä¸‹ä¸€æ­¥è§„åˆ’ï¼ˆStage 1 / Day2ï¼‰

1. **æ¥å…¥ Supabase SDK**ï¼šä½¿ç”¨ SPM æ·»åŠ  `supabase-swift`ï¼Œæ›¿æ¢ä¸´æ—¶ `SupabaseConfig`ï¼Œåˆå§‹åŒ– `SupabaseManager.shared`ã€‚
2. **æ‰“é€šåŒ¿åä¼šè¯**ï¼šåœ¨çœŸæœºä¸ŠéªŒè¯ `AuthManager` ä½¿ç”¨ Supabase å®ŒæˆåŒ¿åç™»å½•/ç™»å‡ºï¼Œç¡®è®¤ç½‘ç»œä¸å¯†é’¥é…ç½®æ— è¯¯ã€‚
3. **å®šä½æ•°æ®å…¥åº“**ï¼šæ‰©å±• `LocationManager` åšå®šæ—¶é‡‡é›†ï¼Œé€šè¿‡ `DataRepository` æŠŠåæ ‡å†™å…¥ Supabase `positions` è¡¨ï¼Œæ–°å¢ `LocationView` å±•ç¤ºä¸Šä¼ çŠ¶æ€ã€‚
4. **ç­¹å¤‡åœ°å›¾æ¨¡å—**ï¼šæ¢³ç† `TerritoryManager` ä¾èµ–ï¼Œé¢„ç•™ MapKit æ¥å£ï¼ˆä½ç½®è®¢é˜…ã€å†å²ç‚¹ç¼“å­˜ï¼‰ï¼Œä¸º Day3 çš„åœˆåœ°åŠŸèƒ½åšå‡†å¤‡ã€‚

å®Œæˆä»¥ä¸Šå››é¡¹å³å¯å°é—­ Stage 1ï¼ˆSupabase çœŸè¿æ¥ + å®šä½ä¸Šä¼ é—­ç¯ï¼‰ï¼ŒéšåæŒ‰åŸè®¡åˆ’æ¨è¿›åœ°å›¾åœˆåœ°ã€å»ºç­‘ç³»ç»Ÿä¸ UI ä¸²è”ï¼Œå†è¿›å…¥ä¸»é¢˜å˜ä½“é˜¶æ®µã€‚
